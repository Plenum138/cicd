{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kalyansingh/Desktop/Project/vivaquad/admin-backend/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kalyansingh/Desktop/Project/vivaquad/admin-backend/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/kalyansingh/Desktop/Project/vivaquad/admin-backend/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/kalyansingh/Desktop/Project/vivaquad/admin-backend/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/kalyansingh/Desktop/Project/vivaquad/admin-backend/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/kalyansingh/Desktop/Project/vivaquad/admin-backend/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import Apploader from'../../components/loader/loader';import{connect}from'dva';import{Card,Typography,Input,Button,Table,Row,Col,Popconfirm,Modal,message,Upload,Select}from'antd';import{DeleteOutlined,EyeOutlined,EditOutlined}from'@ant-design/icons';// import AddEdit from './action/addEdit'\nimport axios from'axios';var Search=Input.Search;var Text=Typography.Text;var Option=Select.Option;var baseUrl=process.env.REACT_APP_ApiUrl;var EmployeeList=/*#__PURE__*/function(_React$Component){_inherits(EmployeeList,_React$Component);var _super=_createSuper(EmployeeList);function EmployeeList(props){var _this;_classCallCheck(this,EmployeeList);_this=_super.call(this,props);_this.ListFun=function(){var search='page='+(_this.state.current-1)+\"&limit=\"+_this.state.limit+\"&inactive=\"+_this.state.inactive+\"&searchText=\"+_this.state.searchText+\"&sortBy=\"+_this.state.sortBy;localStorage.setItem('serviceSearch',JSON.stringify(_this.state));var user_id=localStorage.getItem('userId');var searchval={limit:_this.state.limit,role:\"EMPLOYEE\",user_id:user_id};_this.props.dispatch({type:'users/getList',payload:searchval});_this.props.dispatch({type:'lunches/getLunchList',payload:{user_id:user_id}});};_this.ShowSizeChange=function(current,size){return _this.setState({limit:size},function(){return _this.ListFun();});};_this.switchFun=function(val){return _this.setState({inactive:val},function(){return _this.ListFun();});};_this.ChangeOrder=function(val){return _this.setState({sortBy:_this.state.sortBy==='asc'?'desc':'asc'},function(){return _this.ListFun();});};_this.paginationFun=function(val){return _this.setState({current:val.current},function(){return _this.ListFun();});};_this.searchVal=function(val){_this.state.searchText=val;var resultAutos=_this.props.users.list.data.filter(function(auto){return auto.username.toLowerCase().includes(val.toLowerCase())||auto.email.toLowerCase().includes(val.toLowerCase());});_this.setState({listData:resultAutos});};_this.deleteItem=function(id){var val={_id:id};_this.props.dispatch({type:'users/deleteItem',payload:val});};_this.handleDeactiveUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var list,list_update;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:list=_this.state.listData;list_update=list.map(function(item){if(item._id===data){item.user_status=!item.user_status;}return item;});_this.setState({listData:list_update});_context.next=5;return axios.post(\"\".concat(baseUrl,\"/api/user/status\"),{id:data});case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.state={limit:25,current:1,sortBy:'asc',addModel:false,inactive:false,searchText:'',loader:false,detail:'',count:0,listData:[]};setTimeout(function(){return document.title='Employee List';},100);return _this;}_createClass(EmployeeList,[{key:\"componentDidMount\",value:function componentDidMount(){this.ListFun();}},{key:\"handleChange\",value:function handleChange(value,data){var val={val:value,_id:data._id};this.props.dispatch({type:'users/updateLunchHall',payload:val});this.ListFun();}},{key:\"getSnapshotBeforeUpdate\",value:function getSnapshotBeforeUpdate(prevProps,prevState){var del=this.props.users.del;if(del.count>this.state.count&&del.status){this.setState({count:del.count,btndis:false});return true;}else if(del.count>this.state.count&&!del.status){this.setState({count:del.count,btndis:false});}return null;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){if(snapshot){this.ListFun();}}},{key:\"render\",value:function render(){var _lunches$list,_this2=this;var searchText=this.state.searchText;var _this$props=this.props,users=_this$props.users,lunches=_this$props.lunches;var lunchList=lunches===null||lunches===void 0?void 0:(_lunches$list=lunches.list)===null||_lunches$list===void 0?void 0:_lunches$list.data;if(this.state.searchText==''){this.state.listData=users.list?users.list.data:[];}var columns=[{title:/*#__PURE__*/React.createElement(\"strong\",{className:\"primary-text cursor\",onClick:this.ChangeOrder},\"User Name \",/*#__PURE__*/React.createElement(\"i\",{className:' fal fa-sm '+(this.state.sortBy==='asc'?\"fa-long-arrow-up\":\"fa-long-arrow-down\")})),dataIndex:'username',render:function render(val,data){return/*#__PURE__*/React.createElement(\"div\",{className:data.isActive?\"\":'danger-text'},val);}},{title:/*#__PURE__*/React.createElement(\"strong\",null,\"Employee Role\"),dataIndex:'roleInfo',render:function render(value,row){return/*#__PURE__*/React.createElement(\"span\",null,value===null||value===void 0?void 0:value.roles);}},{title:/*#__PURE__*/React.createElement(\"strong\",null,\"Email\"),dataIndex:'email'},{title:/*#__PURE__*/React.createElement(\"strong\",null,\"Email Verified\"),dataIndex:'isEmailVerified',render:function render(val,data){return val?'Yes':'No';}},{title:/*#__PURE__*/React.createElement(\"strong\",null,\"Assign Lunch Hall \"),dataIndex:'hall_id',render:function render(val,data){var _data$roleInfo;return(data===null||data===void 0?void 0:(_data$roleInfo=data.roleInfo)===null||_data$roleInfo===void 0?void 0:_data$roleInfo.roles)==='Lunch Worker'?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Select,{labelInValue:true,defaultValue:{value:val},style:{width:200},onChange:function onChange(e){_this2.handleChange(e,data);}},lunchList&&(lunchList===null||lunchList===void 0?void 0:lunchList.map(function(item,index){return/*#__PURE__*/React.createElement(Select.Option,{key:index,value:item===null||item===void 0?void 0:item._id},item===null||item===void 0?void 0:item.hall_name);})))):/*#__PURE__*/React.createElement(\"h4\",null,/*#__PURE__*/React.createElement(\"span\",{class:\"badge badge-secondary\"},\"Can Not Assign\"));}},{title:/*#__PURE__*/React.createElement(\"strong\",null,\" Status \"),dataIndex:'user_status',render:function render(val,data){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Popconfirm,{title:\"Are you sure you want to \".concat(data.user_status?\"Deactivate\":\"Activate\",\" this user?\"),onConfirm:function onConfirm(e){_this2.handleDeactiveUser(data._id);},okText:\"Yes\",cancelText:\"No\"},/*#__PURE__*/React.createElement(Button,{type:\"default\"},\" \",data.user_status&&data.user_status?\"Activated\":\"Deactivated\",\"  \")));}},{title:/*#__PURE__*/React.createElement(\"strong\",null,\"Action\"),width:150,//align:'center',\nrender:function render(val,data){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{className:\"eye_btn\",type:\"default\",onClick:function onClick(){_this2.props.history.push('/employee/view/'+data._id);}},/*#__PURE__*/React.createElement(EyeOutlined,null)),\"\\xA0\",/*#__PURE__*/React.createElement(Button,{className:\"edit_btn\",type:\"default\",onClick:function onClick(){_this2.props.history.push('/employee/edit/'+data._id);}},/*#__PURE__*/React.createElement(EditOutlined,null)),\"\\xA0\",/*#__PURE__*/React.createElement(Popconfirm,{title:\"Are you sure delete this user?\",onConfirm:function onConfirm(e){_this2.deleteItem(data._id);},okText:\"Yes\",cancelText:\"No\"},/*#__PURE__*/React.createElement(Button,{type:\"danger\",className:\"mt-2\"},/*#__PURE__*/React.createElement(DeleteOutlined,null))));}}];return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Apploader,{show:this.props.loading.global}),/*#__PURE__*/React.createElement(Row,{className:\"TopActionBar\",gutter:[16,0],justify:\"space-between\",align:\"middle\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Search,{placeholder:\"Search...\",onChange:function onChange(e){return _this2.searchVal(e.target.value);},value:searchText,loading:this.props.submitting})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Button,{type:\"primary\",onClick:function onClick(){return _this2.props.history.push('/employee/add');}},\"Add\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"innerContainer\"},/*#__PURE__*/React.createElement(Card,{style:{marginTop:\"0\"},bodyStyle:{padding:'0 15px 15px'}},/*#__PURE__*/React.createElement(Table,{columns:columns,dataSource:this.state.listData,onChange:this.paginationFun,rowKey:function rowKey(record){return record._id;},pagination:{position:['bottomLeft'],showTotal:function showTotal(total,range){return/*#__PURE__*/React.createElement(Text,{type:\"secondary\"},\"Showing \".concat(range[0],\"-\").concat(range[1],\" of \").concat(total));},showSizeChanger:true,responsive:true,onShowSizeChange:function onShowSizeChange(current,size){return _this2.ShowSizeChange(current,size);},pageSizeOptions:['25','50','100','250','500']}}))));}}]);return EmployeeList;}(React.Component);;export default connect(function(_ref2){var users=_ref2.users,lunches=_ref2.lunches,loading=_ref2.loading;return{users:users,loading:loading,lunches:lunches};})(EmployeeList);","map":{"version":3,"sources":["/Users/kalyansingh/Desktop/Project/vivaquad/admin-backend/admin-vivaquad/src/pages/employees/list.js"],"names":["React","Apploader","connect","Card","Typography","Input","Button","Table","Row","Col","Popconfirm","Modal","message","Upload","Select","DeleteOutlined","EyeOutlined","EditOutlined","axios","Search","Text","Option","baseUrl","process","env","REACT_APP_ApiUrl","EmployeeList","props","ListFun","search","state","current","limit","inactive","searchText","sortBy","localStorage","setItem","JSON","stringify","user_id","getItem","searchval","role","dispatch","type","payload","ShowSizeChange","size","setState","switchFun","val","ChangeOrder","paginationFun","searchVal","resultAutos","users","list","data","filter","auto","username","toLowerCase","includes","email","listData","deleteItem","id","_id","handleDeactiveUser","list_update","map","item","user_status","post","addModel","loader","detail","count","setTimeout","document","title","value","prevProps","prevState","del","status","btndis","snapshot","lunches","lunchList","columns","dataIndex","render","isActive","row","roles","roleInfo","width","e","handleChange","index","hall_name","history","push","loading","global","target","submitting","marginTop","padding","record","position","showTotal","total","range","showSizeChanger","responsive","onShowSizeChange","pageSizeOptions","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Apploader from '../../components/loader/loader'\nimport { connect } from 'dva';\nimport { Card, Typography, Input, Button, Table,  Row, Col, Popconfirm, Modal, message, Upload ,Select} from 'antd';\nimport { DeleteOutlined, EyeOutlined  , EditOutlined} from '@ant-design/icons';\n// import AddEdit from './action/addEdit'\nimport axios from 'axios';\nconst { Search } = Input;\nconst { Text } = Typography;\nconst { Option } = Select;\n\n\nconst baseUrl = process.env.REACT_APP_ApiUrl;\n\nclass EmployeeList extends React.Component { \n  constructor(props) {\n    super(props); \n\tthis.state = { limit:25, current:1, sortBy:'asc', addModel:false, inactive:false, searchText:'', loader:false, detail:'', count:0, listData: []}\n\tsetTimeout(()=>document.title = 'Employee List', 100);\n  }\n\tcomponentDidMount(){\n\t\tthis.ListFun();\n\t}\n\t\n\tListFun=()=>{\n\t\tlet search = 'page='+(this.state.current-1)+\"&limit=\"+this.state.limit+\"&inactive=\"+this.state.inactive+\"&searchText=\"+this.state.searchText+\"&sortBy=\"+this.state.sortBy;\n\t\tlocalStorage.setItem('serviceSearch', JSON.stringify(this.state))\n        let user_id = localStorage.getItem('userId');\n \n\t\tlet searchval = {limit:this.state.limit, role:\"EMPLOYEE\" ,user_id}\n\t\tthis.props.dispatch({type: 'users/getList',  payload: searchval,});\n\t\tthis.props.dispatch({ type: 'lunches/getLunchList', payload: {user_id}, });\n\n\n\t  } \n\n\t  handleChange(value , data) {\n\t\tlet val = {\t \n\t\t\tval :value,\n\t\t\t_id : data._id\n\t\t}\n\nthis.props.dispatch({type: 'users/updateLunchHall', payload:val});\nthis.ListFun();\n\n\n\n\n   }\n  \n\tShowSizeChange=(current, size)  => this.setState({limit:size},()=>this.ListFun());\n\tswitchFun=(val)  => this.setState({inactive:val},()=>this.ListFun());\t\n\tChangeOrder=(val)  =>this.setState({sortBy: this.state.sortBy === 'asc' ? 'desc':'asc'},()=>this.ListFun());\n\tpaginationFun=(val)=> this.setState({current: val.current},()=>this.ListFun());\n\t\n\tsearchVal=(val)=>{\n\t\tthis.state.searchText = val\n\t\tconst resultAutos = this.props.users.list.data.filter((auto) => auto.username.toLowerCase().includes(val.toLowerCase()) || auto.email.toLowerCase().includes(val.toLowerCase()))\n\t\t\n\t\tthis.setState({ listData: resultAutos })\n\t}\n\t\n\t\n\tdeleteItem=(id)=>{\n\t\t\n\t\tlet val = {_id:id}\n\t\tthis.props.dispatch({type: 'users/deleteItem', payload: val});\n\t} \n\t\n\tgetSnapshotBeforeUpdate(prevProps, prevState) {\n\t\t\n\t\tlet del = this.props.users.del;\n        if ( del.count > this.state.count && del.status) {\n            this.setState({count:del.count, btndis:false})\n\t\t\treturn true\n        }else if ( del.count > this.state.count && !del.status) {\n\t\t\tthis.setState({count:del.count, btndis:false})\n\t\t}\n        return null;\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (snapshot) {\n            this.ListFun();\n        }\n    }\n\t\n\thandleDeactiveUser = async (data) => {\n\t\tlet list = this.state.listData;\n\t\tlet list_update = list.map((item) => {\n\t\t\tif(item._id === data) {\n\t\t\t\titem.user_status = !item.user_status;\n\t\t\t}\n\t\t\treturn item;\t\n\t\t})\n\t\tthis.setState({ listData: list_update })\n\t\tawait axios.post(`${baseUrl}/api/user/status`, {id: data});\n\t}\n\n\t\n\trender(){\n\tconst { searchText, } = this.state;\n\tconst {users , lunches} = this.props;\n\tlet lunchList = lunches?.list?.data;\n\n\t\n\tif(this. state.searchText == '') {\n\t this.state.listData = users.list ? users.list.data:[];\n\t}\n\n\tconst columns = [\n\t  {\n\t\ttitle: <strong className=\"primary-text cursor\" onClick={this.ChangeOrder}>User Name <i className={' fal fa-sm '+(this.state.sortBy === 'asc'? \"fa-long-arrow-up\":\"fa-long-arrow-down\")} ></i></strong>,\n\t\tdataIndex: 'username',\n\t\n\t\trender:(val,data)=> <div className={data.isActive ?\"\":'danger-text'}>{val}</div>\n\t  },\n\n\t  { title: <strong>Employee Role</strong>, dataIndex: 'roleInfo',\n\t  render: (value, row) => {\n\t\t  return <span>{value?.roles}</span> \n\t  }\n  },\n  \n\n\n\t  { title:<strong>Email</strong>, dataIndex: 'email',},\n\t  { title:<strong>Email Verified</strong>, dataIndex: 'isEmailVerified', render:(val,data)=> val?'Yes':'No'},\n\n\n\n  { title:<strong>Assign Lunch Hall </strong>, dataIndex: 'hall_id', render:(val,data)=> {\n\n\treturn  data?.roleInfo?.roles === 'Lunch Worker' ?   <div >\n\n  <Select\n  labelInValue\n  defaultValue={{ value:val}}\n  style={{ width: 200 }}\n  onChange={e=> {this.handleChange(e , data)}}\t\n  >\n  {lunchList && lunchList?.map((item, index) => <Select.Option key={index} value={item?._id}>{item?.hall_name}</Select.Option>)}\n  </Select>\t\n  </div>\n  : \n  <h4><span class=\"badge badge-secondary\">Can Not Assign</span></h4>\n  }\n\n},\n\n\n{ title:<strong> Status </strong>, dataIndex: 'user_status', render:(val,data)=> \n\n<div>\n\n   <Popconfirm title={`Are you sure you want to ${data.user_status ? \"Deactivate\" : \"Activate\"} this user?`} onConfirm={e=> {this.handleDeactiveUser(data._id)}} okText=\"Yes\" cancelText=\"No\" >\n\t   <Button type=\"default\" > {data.user_status && data.user_status  ? `Activated` : `Deactivated`}  </Button>\n   </Popconfirm>\n</div>\n},\n\t  { title:<strong>Action</strong>, width:150, //align:'center',\n\t\trender:(val,data)=> \n\t\t<div>\n\t\t\t\n\t\t<Button className=\"eye_btn\" type=\"default\" onClick={()=>{\n\t\t\tthis.props.history.push('/employee/view/'+data._id)}}><EyeOutlined /></Button>&nbsp;\n\n\t\t\t\t\t<Button className=\"edit_btn\" type=\"default\" onClick={()=>{\n\t\t\tthis.props.history.push('/employee/edit/'+data._id)}}><EditOutlined /></Button>&nbsp;\n\t\t<Popconfirm title=\"Are you sure delete this user?\" onConfirm={e=> {this.deleteItem(data._id)}} okText=\"Yes\" cancelText=\"No\" >\n\t\t<Button type=\"danger\" className=\"mt-2\"><DeleteOutlined /></Button>\n\t  </Popconfirm>\n\t  </div>\n\t  },\n\t];\n  return (\n\t<div>\n\t\t<Apploader show={this.props.loading.global}/>\n\t\t<Row className=\"TopActionBar\" gutter={[16,0]} justify=\"space-between\" align=\"middle\">\n\t\t\t<Col>\n\t\t\t\t<Search placeholder=\"Search...\" onChange={(e)=>this.searchVal(e.target.value)} value={searchText}\n\t\t\t\tloading={this.props.submitting}\t/>\n\t\t\t</Col>\n\t\t\t<Col>\n\t\t\t<Button type=\"primary\" onClick={() => this.props.history.push('/employee/add')}>Add</Button>\n\t\t\t</Col>\n\n\t\t\n\t\t</Row>\n\t\t\n\t\t<div className=\"innerContainer\">\n\t\t\t\t<Card style={{marginTop:\"0\"}} bodyStyle={{padding:'0 15px 15px'}}>\n\t\t\t\t  <Table columns={columns} dataSource={this.state.listData} \n\t\t\t\t\tonChange={this.paginationFun}\n\t\t\t\t\trowKey={record => record._id}\n\t\t\t\t\tpagination={{position: ['bottomLeft'], \n\t\t\t\t\t\tshowTotal:(total, range) => <Text type=\"secondary\">{`Showing ${range[0]}-${range[1]} of ${total}`}</Text>, showSizeChanger:true,\n\t\t\t\t\t\tresponsive:true,\n\t\t\t\t\t\tonShowSizeChange:(current, size)=> this.ShowSizeChange(current, size),\n\t\t\t\t\t\tpageSizeOptions:['25','50','100','250','500'],\n\t\t\t\t\t}}\n\t\t\t\t  />\n\t\t\t\t</Card>\n\t\t\t</div>\n\t</div>\n  );\n\t}\n};\n\nexport default connect(({users, lunches,loading}) => ({\n\tusers, loading ,lunches\n}))(EmployeeList);"]},"metadata":{},"sourceType":"module"}