{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kalyansingh/Desktop/Project/cicd/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/kalyansingh/Desktop/Project/cicd/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{login as _login,Register,forgetpassword,resetPassword as _resetPassword,resendOTPTOUser,varifyUser}from'../services/api';import{message}from'antd';export default{namespace:'auth',state:{//data: null,\nlogin:{count:0},forgot:{count:0},reg:{count:0},alrdreg:{count:0},varify_payment:{}},subscriptions:{setup:function setup(_ref){var dispatch=_ref.dispatch,history=_ref.history;}},effects:{varifyOtp:/*#__PURE__*/_regeneratorRuntime.mark(function varifyOtp(_ref2,_ref3){var payload,call,put,response;return _regeneratorRuntime.wrap(function varifyOtp$(_context){while(1){switch(_context.prev=_context.next){case 0:payload=_ref2.payload;call=_ref3.call,put=_ref3.put;_context.next=4;return call(varifyUser,payload);case 4:response=_context.sent;if(response.status){_context.next=9;break;}message.error(response.msg||response.message||response.err,5);_context.next=11;break;case 9:_context.next=11;return put(_objectSpread({type:'varifySuccess'},response));case 11:case\"end\":return _context.stop();}}},varifyOtp);}),resendOtp:/*#__PURE__*/_regeneratorRuntime.mark(function resendOtp(_ref4,_ref5){var payload,call,put,response;return _regeneratorRuntime.wrap(function resendOtp$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:payload=_ref4.payload;call=_ref5.call,put=_ref5.put;_context2.next=4;return call(resendOTPTOUser,payload);case 4:response=_context2.sent;if(!response.status){message.error(response.msg||response.message||response.err,5);}else{if(response.status){message.success(response.msg||response.message||response.err,5);}}case 6:case\"end\":return _context2.stop();}}},resendOtp);}),login:/*#__PURE__*/_regeneratorRuntime.mark(function login(_ref6,_ref7){var _response$user_detail,_response$user_detail2;var payload,call,put,response,hostname,activeRole,role,_role;return _regeneratorRuntime.wrap(function login$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:payload=_ref6.payload;call=_ref7.call,put=_ref7.put;_context3.next=4;return call(_login,payload);case 4:response=_context3.sent;if(response.status){_context3.next=19;break;}if(!(response.msg==\"Your account is not verified\"||response.message==\"Your account is not verified\")){_context3.next=17;break;}message.error(\"please verified your account!\",5);localStorage.setItem(\"flow\",'sin');localStorage.setItem('user',JSON.stringify(response===null||response===void 0?void 0:response.user_detail));localStorage.setItem('user_email',payload.username);localStorage.setItem(\"LoginCred\",JSON.stringify(payload));_context3.next=14;return put(_objectSpread({type:'varify'},response));case 14:return _context3.abrupt(\"return\");case 17:message.error(response.msg||response.message||response.err,5);return _context3.abrupt(\"return\");case 19:if(!(!(response===null||response===void 0?void 0:(_response$user_detail=response.user_detail)===null||_response$user_detail===void 0?void 0:_response$user_detail.payment_status)&&(response===null||response===void 0?void 0:(_response$user_detail2=response.user_detail)===null||_response$user_detail2===void 0?void 0:_response$user_detail2.roles)!==\"ADMIN\")){_context3.next=25;break;}localStorage.setItem(\"stripe_screen\",\"true\");localStorage.setItem('user',JSON.stringify(response===null||response===void 0?void 0:response.user_detail));_context3.next=24;return put(_objectSpread({type:'varify_payment'},response));case 24:return _context3.abrupt(\"return\");case 25:if(!response.status){_context3.next=60;break;}hostname=window.location.hostname;activeRole='ADMIN';if(!(window.location.hostname==='localhost')){_context3.next=45;break;}role=response.user.role;if(!(role!==\"REGULAR\"&&role!==\"GUEST\")){_context3.next=42;break;}localStorage.removeItem('flow');localStorage.removeItem('LoginCred');localStorage.setItem('token',response.accessToken);localStorage.setItem('role',role);localStorage.setItem('user',JSON.stringify(response.user));localStorage.setItem('userId',response.user._id);localStorage.setItem('isEmailVerified',response.user_detail.isEmailVerified?response.user_detail.isEmailVerified===true?'true':'false':'false');_context3.next=40;return put(_objectSpread({type:'save'},response));case 40:_context3.next=43;break;case 42:message.error(\"You are not authorized to Login...!\",5);case 43:_context3.next=60;break;case 45:_role=response.user.role;if(!(_role===activeRole||_role==='SUBADMIN')){_context3.next=59;break;}localStorage.removeItem('flow');localStorage.removeItem('LoginCred');localStorage.setItem('token',response.accessToken);localStorage.setItem('role',_role);localStorage.setItem('user',JSON.stringify(response.user));localStorage.setItem('userId',response.user._id);localStorage.setItem('isMobileVerified',response.user.isMobileVerified?response.user.isMobileVerified===true?'true':'false':'false');localStorage.setItem('isEmailVerified',response.user.isEmailVerified?response.user.isEmailVerified===true?'true':'false':'false');_context3.next=57;return put(_objectSpread({type:'save'},response));case 57:_context3.next=60;break;case 59:message.error(\"You are not authorized to Login...!\",5);case 60:case\"end\":return _context3.stop();}}},login);}),forgotFun:/*#__PURE__*/_regeneratorRuntime.mark(function forgotFun(_ref8,_ref9){var payload,call,put,response;return _regeneratorRuntime.wrap(function forgotFun$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:payload=_ref8.payload;call=_ref9.call,put=_ref9.put;_context4.next=4;return call(forgetpassword,payload);case 4:response=_context4.sent;if(!response.status){message.error(response.msg||response.message||response.err,5);}if(response.status){message.success(response.msg||response.message||response.err,5);}localStorage.setItem(\"flow\",'forgot');localStorage.setItem('user_email',payload.username);_context4.next=11;return put(_objectSpread({type:'forgot'},response));case 11:case\"end\":return _context4.stop();}}},forgotFun);}),resetPassword:/*#__PURE__*/_regeneratorRuntime.mark(function resetPassword(_ref10,_ref11){var payload,call,put,response;return _regeneratorRuntime.wrap(function resetPassword$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:payload=_ref10.payload;call=_ref11.call,put=_ref11.put;_context5.next=4;return call(_resetPassword,payload);case 4:response=_context5.sent;console.log(response);if(response.status){_context5.next=10;break;}message.error(response.msg||response.message||\"Something Went to wrong...Please Try Again!\",5);_context5.next=13;break;case 10:message.success(response.msg||response.message||\"Password Successfully Changed... Login again!\",5);_context5.next=13;return put(_objectSpread({type:'resetPasswordSuccess'},response));case 13:case\"end\":return _context5.stop();}}},resetPassword);}),register:/*#__PURE__*/_regeneratorRuntime.mark(function register(_ref12,_ref13){var payload,call,put,response;return _regeneratorRuntime.wrap(function register$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:payload=_ref12.payload;call=_ref13.call,put=_ref13.put;_context6.next=4;return call(Register,payload);case 4:response=_context6.sent;if(response.status){_context6.next=21;break;}if(!(response.msg==\"This Email is already registered\"||response.message==\"This Email is already registered\")){_context6.next=12;break;}message.success(\"Your email is already register in Vivaquad so login with your email & password..!\",5);_context6.next=10;return put(_objectSpread({type:'alrdreg'},response));case 10:_context6.next=19;break;case 12:if(!(response.msg==\"This Mobile No is already registered\"||response.message==\"This Mobile No is already registered\")){_context6.next=18;break;}message.success(\"Your mobile number is already register in Vivaquad so login with your mobile number & password..!\",5);_context6.next=16;return put(_objectSpread({type:'alrdreg'},response));case 16:_context6.next=19;break;case 18:message.error(response.msg||response.message||response.err,5);case 19:_context6.next=27;break;case 21:if(response.status){}console.log(response);console.log(response===null||response===void 0?void 0:response.otp);localStorage.setItem(\"user\",JSON.stringify(response===null||response===void 0?void 0:response.user));_context6.next=27;return put(_objectSpread({type:'reg'},response));case 27:case\"end\":return _context6.stop();}}},register);}),logoutApp:/*#__PURE__*/_regeneratorRuntime.mark(function logoutApp(_ref14,_ref15){var _,call,put;return _regeneratorRuntime.wrap(function logoutApp$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_=_ref14._;call=_ref15.call,put=_ref15.put;localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('user');_context7.next=7;return put({type:'logout'});case 7:case\"end\":return _context7.stop();}}},logoutApp);})},reducers:{otpSendSuccess:function otpSendSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:_objectSpread({},action),login:{count:0}});},varifySuccess:function varifySuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:_objectSpread({},action),login:{count:0}});},save:function save(state,action){action.count=state.login.count+1;return _objectSpread(_objectSpread({},state),{},{login:action,varify:{}});},varify:function varify(state,action){return _objectSpread(_objectSpread({},state),{},{login:'varify',varify:{}});},forgot:function forgot(state,action){action.count=state.forgot.count+1;return _objectSpread(_objectSpread({},state),{},{forgot:action});},resetPasswordSuccess:function resetPasswordSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{resetPassword:_objectSpread({},action),forgot:{}});},resetPasswordSuccessDone:function resetPasswordSuccessDone(state,action){return _objectSpread(_objectSpread({},state),{},{resetPassword:{}});},registerSuccess:function registerSuccess(state,action){action.count=0;return _objectSpread(_objectSpread({},state),{},{reg:{count:0}});},alrdregisterSuccess:function alrdregisterSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:{},login:{count:0}});},verifyBackNuttunSuccess:function verifyBackNuttunSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:{},login:{count:0}});},verotpSuccess:function verotpSuccess(state,action){action.count=0;return _objectSpread(_objectSpread({},state),{},{alrdreg:{count:0}});},alrdreg:function alrdreg(state,action){action.count=state.alrdreg.count+1;return _objectSpread(_objectSpread({},state),{},{alrdreg:{action:action}});},reg:function reg(state,action){action.count=state.reg.count+1;return _objectSpread(_objectSpread({},state),{},{reg:{action:action}});},logout:function logout(state){return _objectSpread(_objectSpread({},state),{},{login:{count:0},reg:{count:0}});},varify_payment:function varify_payment(state,action){return _objectSpread(_objectSpread({},state),{},{varify_payment:action});}}};","map":{"version":3,"sources":["/Users/kalyansingh/Desktop/Project/cicd/admin-vivaquad/src/models/auth.js"],"names":["login","Register","forgetpassword","resetPassword","resendOTPTOUser","varifyUser","message","namespace","state","count","forgot","reg","alrdreg","varify_payment","subscriptions","setup","dispatch","history","effects","varifyOtp","payload","call","put","response","status","error","msg","err","type","resendOtp","success","localStorage","setItem","JSON","stringify","user_detail","username","payment_status","roles","hostname","window","location","activeRole","role","user","removeItem","accessToken","_id","isEmailVerified","isMobileVerified","forgotFun","console","log","register","otp","logoutApp","_","reducers","otpSendSuccess","action","varify","varifySuccess","save","resetPasswordSuccess","resetPasswordSuccessDone","registerSuccess","alrdregisterSuccess","verifyBackNuttunSuccess","verotpSuccess","logout"],"mappings":"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","sourcesContent":["import { login,  Register, forgetpassword, resetPassword, resendOTPTOUser, varifyUser } from '../services/api'\r\nimport { message } from 'antd';\r\nexport default {\r\n  namespace: 'auth',\r\n\r\n  state: {\r\n    //data: null,\r\n    login: { count: 0 },\r\n    forgot: { count: 0 },\r\n    reg: { count: 0 },\r\n    alrdreg: { count: 0 },\r\n    varify_payment: {},\r\n\r\n  },\r\n\r\n  subscriptions: {\r\n    setup({ dispatch, history }) {\r\n    },\r\n  },\r\n\r\n  effects: {\r\n    *varifyOtp({ payload }, { call, put }) {\r\n      const response = yield call(varifyUser, payload);\r\n      if (!response.status) {\r\n        message.error(response.msg || response.message || response.err, 5);\r\n      } else {\r\n        yield put({ type: 'varifySuccess', ...response });\r\n      }\r\n    },\r\n    *resendOtp({ payload }, { call, put }) {\r\n      const response = yield call(resendOTPTOUser, payload);\r\n      if (!response.status) {\r\n        message.error(response.msg || response.message || response.err, 5);\r\n      } else {\r\n        if (response.status) { message.success(response.msg || response.message || response.err, 5); }\r\n      }\r\n    },\r\n    *login({ payload }, { call, put }) {\r\n      const response = yield call(login, payload);\r\n\r\n     \r\n\r\n      if (!response.status) {\r\n        if (response.msg == \"Your account is not verified\" || response.message == \"Your account is not verified\") {\r\n          message.error(\"please verified your account!\", 5);\r\n\r\n          localStorage.setItem(\"flow\", 'sin');\r\n        localStorage.setItem('user', JSON.stringify(response?.user_detail))\r\n\r\n          localStorage.setItem('user_email', payload.username);\r\n          localStorage.setItem(\"LoginCred\", JSON.stringify(payload));\r\n        yield put({ type: 'varify', ...response });\r\n\r\n          return \r\n\r\n\r\n        } else {\r\n          message.error(response.msg || response.message || response.err, 5);\r\n          return \r\n        }\r\n      }\r\n\r\n\r\n\r\n\r\n      if(!response?.user_detail?.payment_status && response?.user_detail?.roles !== \"ADMIN\") {\r\n\r\n        localStorage.setItem(\"stripe_screen\", \"true\");\r\n        localStorage.setItem('user', JSON.stringify(response?.user_detail))\r\n        yield put({ type: 'varify_payment', ...response });\r\n        return ;\r\n      }\r\n      if (response.status) {\r\n        let hostname = window.location.hostname;\r\n\r\n        let activeRole = 'ADMIN';\r\n           if(window.location.hostname === 'localhost') {\r\n            let role = response.user.role;\r\n            if (role !== \"REGULAR\" && role !== \"GUEST\") //For localhost \r\n            {\r\n              localStorage.removeItem('flow');\r\n              localStorage.removeItem('LoginCred')\r\n              localStorage.setItem('token', response.accessToken);\r\n              localStorage.setItem('role', role);\r\n              localStorage.setItem('user', JSON.stringify(response.user));\r\n              localStorage.setItem('userId', response.user._id);\r\n  \r\n              localStorage.setItem('isEmailVerified', response.user_detail.isEmailVerified ? response.user_detail.isEmailVerified === true ? 'true' : 'false' : 'false');\r\n              yield put({ type: 'save', ...response });\r\n            } else {\r\n              message.error(\"You are not authorized to Login...!\", 5);\r\n            }\r\n          }else {\r\n            let role = response.user.role;\r\n            if (role === activeRole || role === 'SUBADMIN') //For localhost \r\n            { \r\n              \r\n              localStorage.removeItem('flow');\r\n              localStorage.removeItem('LoginCred')\r\n              localStorage.setItem('token', response.accessToken);\r\n              localStorage.setItem('role', role);\r\n              localStorage.setItem('user', JSON.stringify(response.user));\r\n              localStorage.setItem('userId', response.user._id);\r\n              localStorage.setItem('isMobileVerified', response.user.isMobileVerified ? response.user.isMobileVerified === true ? 'true' : 'false' : 'false');\r\n              localStorage.setItem('isEmailVerified', response.user.isEmailVerified ? response.user.isEmailVerified === true ? 'true' : 'false' : 'false');\r\n\r\n              yield put({ type: 'save', ...response });\r\n            } else {\r\n              message.error(\"You are not authorized to Login...!\", 5);\r\n            }\r\n          }\r\n        }\r\n    },\r\n    *forgotFun({ payload }, { call, put }) {\r\n      const response = yield call(forgetpassword, payload);\r\n      if (!response.status) { message.error(response.msg || response.message || response.err, 5); }\r\n      if (response.status) { message.success(response.msg || response.message || response.err, 5); }\r\n      localStorage.setItem(\"flow\", 'forgot');\r\n      localStorage.setItem('user_email', payload.username);\r\n      yield put({ type: 'forgot', ...response });\r\n    },\r\n    *resetPassword({ payload }, { call, put }) {\r\n      const response = yield call(resetPassword, payload);\r\n      console.log(response)\r\n      if (!response.status) {\r\n        message.error(response.msg || response.message || \"Something Went to wrong...Please Try Again!\", 5);\r\n      } else {\r\n        message.success(response.msg || response.message || \"Password Successfully Changed... Login again!\", 5);\r\n        yield put({ type: 'resetPasswordSuccess', ...response });\r\n      }\r\n\r\n    },\r\n    *register({ payload }, { call, put }) {\r\n      const response = yield call(Register, payload);\r\n      if (!response.status) {\r\n        if (response.msg == \"This Email is already registered\" || response.message == \"This Email is already registered\") {\r\n          message.success(\"Your email is already register in Vivaquad so login with your email & password..!\", 5);\r\n          yield put({ type: 'alrdreg', ...response });\r\n        } else if (response.msg == \"This Mobile No is already registered\" || response.message == \"This Mobile No is already registered\") {\r\n          message.success(\"Your mobile number is already register in Vivaquad so login with your mobile number & password..!\", 5);\r\n          yield put({ type: 'alrdreg', ...response });\r\n        } else {\r\n          message.error(response.msg || response.message || response.err, 5);\r\n        }\r\n      } else {\r\n\r\n\r\n        if (response.status) { \r\n\r\n         }\r\n\r\n\r\n         console.log(response)\r\n         console.log(response?.otp)\r\n\r\n         localStorage.setItem(\"user\", JSON.stringify(response?.user));\r\n\r\n        yield put({ type: 'reg', ...response });\r\n      }\r\n\r\n    },\r\n    *logoutApp({ _ }, { call, put }) {\r\n      localStorage.removeItem('token')\r\n      localStorage.removeItem('role')\r\n      localStorage.removeItem('user')\r\n      yield put({ type: 'logout' });\r\n    },\r\n  },\r\n\r\n  reducers: {\r\n    otpSendSuccess(state, action) {\r\n      return {\r\n        ...state,\r\n        varify: { ...action }, login: { count: 0 }\r\n      };\r\n    },\r\n    varifySuccess(state, action) {\r\n      return {\r\n        ...state,\r\n        varify: { ...action }, login: { count: 0 }\r\n      };\r\n    },\r\n    save(state, action) {\r\n      action.count = state.login.count + 1;\r\n      return {\r\n        ...state,\r\n        login: action, varify: {}\r\n      };\r\n    },\r\n    varify(state, action) {\r\n      return {\r\n        ...state,\r\n        login: 'varify', varify: {}\r\n      };\r\n    },\r\n    forgot(state, action) {\r\n      action.count = state.forgot.count + 1;\r\n      return { ...state, forgot: action };\r\n    },\r\n    resetPasswordSuccess(state, action) {\r\n      return {\r\n        ...state,\r\n        resetPassword: { ...action }, forgot: {}\r\n      };\r\n    },\r\n    resetPasswordSuccessDone(state, action) {\r\n      return { ...state, resetPassword: {} };\r\n    },\r\n    registerSuccess(state, action) {\r\n      action.count = 0;\r\n      return { ...state, reg: { count: 0 } };\r\n    },\r\n    alrdregisterSuccess(state, action) {\r\n      return { ...state, varify: {}, login: { count: 0 } };\r\n    },\r\n    verifyBackNuttunSuccess(state, action) {\r\n      return { ...state, varify: {}, login: { count: 0 } };\r\n    },\r\n    verotpSuccess(state, action) {\r\n      action.count = 0;\r\n      return { ...state, alrdreg: { count: 0 } };\r\n    },\r\n    alrdreg(state, action) {\r\n      action.count = state.alrdreg.count + 1;\r\n      return {\r\n        ...state,\r\n        alrdreg: { action }\r\n      };\r\n    },\r\n    reg(state, action) {\r\n      action.count = state.reg.count + 1;\r\n      return {\r\n        ...state,\r\n        reg: { action }\r\n      };\r\n    },\r\n    logout(state) {\r\n      return { ...state, login: { count: 0 }, reg: { count: 0 } };\r\n    },\r\n    varify_payment(state, action) {\r\n \r\n      return {\r\n        ...state,\r\n        varify_payment:action,\r\n      };\r\n    },\r\n  },\r\n};"]},"metadata":{},"sourceType":"module"}